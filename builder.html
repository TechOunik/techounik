<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio & Resume Factory | OBI_SEC</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #165b33; --accent: #d42426; --bg: #f8f9fa; --text: #333; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); padding: 40px 20px; color: var(--text); }
        .container { max-width: 900px; margin: 0 auto; background: white; padding: 40px; border-radius: 20px; box-shadow: 0 15px 40px rgba(0,0,0,0.1); }
        
        h1 { text-align: center; color: var(--primary); font-size: 2.2rem; margin-bottom: 10px; }
        .subtitle { text-align: center; color: #666; margin-bottom: 40px; }

        /* CATEGORY FILTER */
        .category-filter { display: flex; justify-content: center; gap: 10px; margin-bottom: 20px; flex-wrap: wrap; }
        .cat-btn { padding: 8px 15px; border: 1px solid #ddd; border-radius: 20px; cursor: pointer; background: white; font-size: 0.9rem; transition: 0.3s; }
        .cat-btn:hover, .cat-btn.active { background: var(--primary); color: white; border-color: var(--primary); }

        /* THEME ACCORDION */
        .theme-accordion { border: 2px solid #eee; border-radius: 10px; overflow: hidden; margin-bottom: 30px; }
        .accordion-header { background: #f1f1f1; padding: 15px 20px; cursor: pointer; font-weight: bold; display: flex; justify-content: space-between; align-items: center; }
        .accordion-header:hover { background: #e9e9e9; }
        .accordion-body { padding: 20px; display: none; background: white; }
        .accordion-body.open { display: block; }

        /* THEME GRID */
        .theme-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 15px; }
        .theme-card { border: 2px solid #eee; border-radius: 10px; padding: 15px; cursor: pointer; text-align: center; transition: 0.3s; position: relative; }
        .theme-card:hover { transform: translateY(-3px); border-color: #ccc; }
        .theme-card.selected { border-color: var(--primary); background: #e8f5e9; }
        .badge { position: absolute; top: 10px; right: 10px; font-size: 0.7rem; padding: 3px 8px; border-radius: 10px; color: white; }
        .badge-free { background: #28a745; }
        .badge-paid { background: var(--accent); }

        /* FORM */
        .form-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .full-width { grid-column: span 2; }
        
        label { display: block; margin-top: 15px; font-weight: bold; font-size: 0.9rem; }
        input, textarea, select { width: 100%; padding: 12px; margin-top: 5px; border: 2px solid #eee; border-radius: 8px; box-sizing: border-box; }
        input:focus { border-color: var(--primary); outline: none; }

        /* IMAGE UPLOAD */
        .file-upload { border: 2px dashed #ccc; padding: 20px; text-align: center; border-radius: 10px; margin-top: 10px; cursor: pointer; }
        .file-upload:hover { border-color: var(--primary); background: #f9fffb; }
        #preview-img { max-width: 100px; max-height: 100px; border-radius: 50%; margin-top: 10px; display: none; border: 2px solid var(--primary); }

        .btn-generate { width: 100%; padding: 18px; background: var(--primary); color: white; border: none; border-radius: 10px; font-size: 1.2rem; font-weight: bold; margin-top: 30px; cursor: pointer; transition: 0.3s; }
        .btn-generate:hover { background: #0f4224; }

        @media(max-width: 600px) { .form-grid { grid-template-columns: 1fr; } .full-width { grid-column: span 1; } }
    </style>
</head>
<body>

<div class="container">
    <h1>üè≠ Portfolio & Resume Factory</h1>
    <p class="subtitle">Select a professional template, upload your details, and launch.</p>

    <div class="theme-accordion">
        <div class="accordion-header" onclick="toggleAccordion()">
            <span>üé® Step 1: Select Your Theme (Click to Expand)</span>
            <i class="fas fa-chevron-down"></i>
        </div>
        <div class="accordion-body" id="themeBody">
            
            <div class="category-filter">
                <button class="cat-btn active" onclick="filterThemes('all')">All</button>
                <button class="cat-btn" onclick="filterThemes('tech')">Technology</button>
                <button class="cat-btn" onclick="filterThemes('medical')">Medical</button>
                <button class="cat-btn" onclick="filterThemes('creative')">Creative</button>
                <button class="cat-btn" onclick="filterThemes('resume')">Resumes</button>
            </div>

            <div class="theme-grid" id="themeGrid">
                </div>
            <input type="hidden" id="selectedThemeId" value="free_sidebar">
        </div>
    </div>

    <form id="portfolioForm">
        <div class="form-grid">
            
            <div class="full-width">
                <label>Profile Picture (PNG Only for Security)</label>
                <div class="file-upload" onclick="document.getElementById('photoInput').click()">
                    <i class="fas fa-cloud-upload-alt" style="font-size: 1.5rem; color:#888;"></i>
                    <p style="margin:5px 0; font-size:0.9rem;">Click to upload (Max 2MB)</p>
                    <input type="file" id="photoInput" accept="image/png" style="display:none" onchange="handleImageUpload()">
                </div>
                <center><img id="preview-img"></center>
                <input type="hidden" id="base64Image">
            </div>

            <div>
                <label>Full Name</label>
                <input type="text" id="fullName" placeholder="e.g. Obioma Uzoh">
            </div>
            <div>
                <label>Profession / Title</label>
                <input type="text" id="jobTitle" placeholder="e.g. Cybersecurity Analyst">
            </div>
            <div class="full-width">
                <label>Professional Bio</label>
                <textarea id="bio" rows="3" placeholder="Brief summary of who you are..."></textarea>
            </div>
            <div>
                <label>Email</label>
                <input type="email" id="email" placeholder="contact@me.com">
            </div>
            <div>
                <label>Link (LinkedIn/GitHub)</label>
                <input type="text" id="social" placeholder="https://...">
            </div>
            <div class="full-width">
                <label>Skills (Comma separated)</label>
                <input type="text" id="skills" placeholder="HTML, Python, Nursing, Design...">
            </div>
        </div>

        <button type="button" class="btn-generate" onclick="generate()">üöÄ Build It Now</button>
    </form>
</div>

<script>
    /* ================= DATA: YOUR 20 THEMES GO HERE ================= */
    const themes = [
        { id: 'free_sidebar', name: 'Cyber Sidebar', cat: 'tech', type: 'free', icon: 'üõ°Ô∏è' },
        { id: 'free_minimal', name: 'Modern Minimal', cat: 'creative', type: 'free', icon: 'üìÑ' },
        { id: 'free_nurse',   name: 'Care Giver',     cat: 'medical', type: 'free', icon: '‚öïÔ∏è' },
        { id: 'free_resume',  name: 'Simple Resume',  cat: 'resume',  type: 'free', icon: 'üìù' },
        { id: 'paid_hacker',  name: 'Hacker Elite',   cat: 'tech',    type: 'paid', icon: 'üî•' },
        { id: 'paid_corp',    name: 'CEO Executive',  cat: 'creative',type: 'paid', icon: 'üíº' },
        { id: 'paid_doctor',  name: 'Dr. Surgeon',    cat: 'medical', type: 'paid', icon: 'üè•' },
        { id: 'paid_cv_pro',  name: 'CV Professional',cat: 'resume',  type: 'paid', icon: '‚≠ê' }
        // ... You can add more here later!
    ];

    /* ================= LOGIC: RENDER THEMES ================= */
    const grid = document.getElementById('themeGrid');
    
    function renderThemes(filter) {
        grid.innerHTML = '';
        themes.forEach(t => {
            if (filter === 'all' || t.cat === filter) {
                const card = document.createElement('div');
                card.className = `theme-card ${t.id === document.getElementById('selectedThemeId').value ? 'selected' : ''}`;
                card.onclick = () => selectTheme(t.id, card);
                card.innerHTML = `
                    <span class="badge badge-${t.type}">${t.type === 'free' ? 'FREE' : '‚Ç¶5k'}</span>
                    <div style="font-size:2rem; margin-bottom:10px;">${t.icon}</div>
                    <strong>${t.name}</strong>
                `;
                grid.appendChild(card);
            }
        });
    }

    // Initial Render
    renderThemes('all');

    function filterThemes(cat) {
        document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        renderThemes(cat);
    }

    function selectTheme(id, el) {
        document.getElementById('selectedThemeId').value = id;
        document.querySelectorAll('.theme-card').forEach(c => c.classList.remove('selected'));
        el.classList.add('selected');
    }

    function toggleAccordion() {
        document.getElementById('themeBody').classList.toggle('open');
    }

    /* ================= LOGIC: IMAGE SECURITY CHECK ================= */
    function handleImageUpload() {
        const input = document.getElementById('photoInput');
        const file = input.files[0];
        
        if (file) {
            // SECURITY: Check File Type
            if (file.type !== 'image/png') {
                alert("SECURITY ALERT: Only .png files are allowed to prevent script injection.");
                input.value = ''; // Clear input
                return;
            }
            // SECURITY: Check File Size (2MB limit)
            if (file.size > 2 * 1024 * 1024) {
                alert("File too large. Max 2MB.");
                return;
            }

            // Convert to Base64 to embed in HTML
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('base64Image').value = e.target.result;
                const preview = document.getElementById('preview-img');
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
    }

    /* ================= LOGIC: GENERATOR ================= */
    function generate() {
        const id = document.getElementById('selectedThemeId').value;
        const name = document.getElementById('fullName').value;
        const role = document.getElementById('jobTitle').value;
        const bio = document.getElementById('bio').value;
        const img = document.getElementById('base64Image').value || 'https://via.placeholder.com/150';
        const skills = document.getElementById('skills').value.split(',').map(s => `<span>${s.trim()}</span>`).join('');
        
        if (!name) { alert("Please enter your name!"); return; }

        const selectedTheme = themes.find(t => t.id === id);

        if (selectedTheme.type === 'paid') {
            // PAID FLOW
            const msg = `*ORDER REQUEST*%0A%0ATheme: ${selectedTheme.name}%0AName: ${name}%0A%0A_I want to pay ‚Ç¶5,000._`;
            // REPLACE NUMBER HERE
            window.open(`https://wa.me/234XXXXXXXXXX?text=${msg}`, '_blank');
        } else {
            // FREE FLOW: Generate Code based on Category
            let html = "";
            
            // --- TEMPLATE: MEDICAL / CLEAN ---
            if (selectedTheme.cat === 'medical' || selectedTheme.id === 'free_minimal') {
                html = `<!DOCTYPE html><html><head><title>${name}</title><style>body{font-family:sans-serif;text-align:center;padding:50px;background:#fff;color:#333}img{width:150px;height:150px;border-radius:50%;object-fit:cover;border:5px solid #eef}h1{margin-bottom:0;color:#2c3e50}.role{color:#16a085;font-weight:bold;text-transform:uppercase;letter-spacing:1px}.skills span{background:#f1f1f1;padding:5px 10px;border-radius:20px;margin:5px;display:inline-block;font-size:0.8rem}</style></head><body><img src="${img}"><h1>${name}</h1><p class="role">${role}</p><p style="max-width:600px;margin:20px auto">${bio}</p><div class="skills">${skills}</div><br><a href="mailto:${document.getElementById('email').value}">Contact Me</a></body></html>`;
            }
            // --- TEMPLATE: RESUME / CV ---
            else if (selectedTheme.cat === 'resume') {
                html = `<!DOCTYPE html><html><head><title>${name} - Resume</title><style>body{font-family:'Times New Roman',serif;max-width:800px;margin:40px auto;padding:40px;border:1px solid #ddd;box-shadow:0 0 10px rgba(0,0,0,0.1)}header{border-bottom:2px solid #333;padding-bottom:20px;margin-bottom:20px;display:flex;justify-content:space-between;align-items:center}.name{font-size:2.5rem;font-weight:bold}.contact{text-align:right;font-size:0.9rem}h2{background:#eee;padding:5px 10px;margin-top:30px}</style></head><body><header><div><div class="name">${name}</div><div>${role}</div></div><img src="${img}" style="width:80px;height:80px;border-radius:5px;"></header><p>${bio}</p><h2>SKILLS</h2><div>${skills}</div><h2>EXPERIENCE</h2><p>Generated by OBI_SEC Resume Builder</p></body></html>`;
            }
            // --- TEMPLATE: TECH (Default) ---
            else {
                html = `<!DOCTYPE html><html><head><title>${name}</title><style>body{font-family:'Courier New',monospace;background:#111;color:#0f0;padding:40px}.container{border:1px solid #0f0;padding:20px;max-width:800px;margin:0 auto}img{width:120px;border-radius:50%;border:2px solid #0f0}a{color:#fff}</style></head><body><div class="container"><center><img src="${img}"></center><h1>> ${name}</h1><h3>> ${role}</h3><p>${bio}</p><hr style="border-color:#0f0"><h4>> SKILLS_LOADED:</h4><div>${skills}</div><br><button onclick="window.print()">Save as PDF</button></div></body></html>`;
            }

            const element = document.createElement('a');
            element.setAttribute('href', 'data:text/html;charset=utf-8,' + encodeURIComponent(html));
            element.setAttribute('download', 'index.html');
            document.body.appendChild(element);
            element.click();
            document.body.removeChild(element);
        }
    }
</script>

</body>
</html>
